## Документация файлов проекта CryptoCam

App.kt
Класс Application для всего приложения.
Функции: onCreate() - создает канал уведомлений, инициализирует KeyManager и глобальные сервисы.
Ответственность: настройка глобального состояния приложения.

MainActivity.kt
Главная активность приложения, обрабатывает навигацию и интенты.
Функции: onCreate() - настраивает UI, обрабатывает интенты; handleIntent() - обрабатывает различные действия; regularStart() - определяет начальный экран; nextOnboardingScreen() - переход к следующему экрану онбординга.
Ответственность: управление навигацией, онбордингом и обработкой внешних команд.

RecordingService.kt
Сервис для записи видео в фоне.
Функции: onCreate() - инициализирует камеру, ориентацию, проверяет HEVC поддержку; handleStartCommand() - обрабатывает команду запуска записи; handleStopCommand() - останавливает запись; startRecording() - начинает запись; stopRecording() - останавливает запись; toggleFlash() - переключает вспышку; toggleCamera() - переключает камеру; initUseCases() - настраивает камеру и видеозахват; initRecording() - инициализирует менеджер записи.
Ответственность: управление камерой, записью видео, фоновой службой.

KeyManager.kt
Менеджер ключей шифрования.
Функции: importRecipient() - импортирует новый ключ; deleteRecipient() - удаляет ключ; setRecipientSelected() - выбирает/снимает выбор ключа; readAvailableKeysFromStorage() - читает ключи из хранилища; parseRecipient() - парсит ключ из имени и публичного ключа.
Ответственность: управление ключами шифрования X25519.

VideoFragment.kt
Фрагмент для экрана видео.
Функции: onServiceBound() - привязка к RecordingService; setupUi() - настраивает UI элементы; onStateChanged() - обновляет UI в зависимости от состояния сервиса; setUpPreview() - настраивает превью камеры; rotateUiTo() - поворачивает UI при изменении ориентации.
Ответственность: отображение интерфейса для видео, управление превью и жестами.

OutputFileManager.kt
Менеджер выходных файлов для зашифрованных видео и изображений.
Функции: newVideoFile() - создает новый зашифрованный файл для видео; newImageFile() - создает новый зашифрованный файл для изображения; finalizeVideoFile() - финализирует видео файл; nextFileName() - генерирует следующее имя файла; writePlainTextHeader() - записывает заголовок с отпечатками ключей; writeHeader() - записывает заголовок с типом файла.
Ответственность: создание и управление зашифрованными файлами с метаданными.

RecordingManager.kt
Менеджер процесса записи видео.
Функции: setUp() - настраивает обработчики буферов; recordButtonClicked() - начинает или останавливает запись; onRecordingFinished() - обрабатывает завершение записи.
Ответственность: координация записи видео и аудио буферов в зашифрованный файл.

ApiConstants.kt
Объект с константами для API действий и параметров.
Функции: определяет строковые константы для действий Intent, режимов, кодеков.
Ответственность: хранение констант для управления приложением через CLI.

Orientation.kt
Определение ориентации устройства.
Функции: enum класс Orientation с значениями PORTRAIT, LAND_LEFT, LAND_RIGHT.
Ответственность: представление ориентации экрана.

PermissionRationaleActivity.kt
Активность для объяснения разрешений.
Функции: onCreate() - показывает диалог с объяснением необходимости разрешений.
Ответственность: объяснение пользователю почему нужны разрешения.

RecordingParams.kt
Класс параметров записи.
Функции: data class RecordingParams с полями для режима, разрешения, кодека и т.д.
Ответственность: хранение параметров для настройки записи.

SelectedCamera.kt
Перечисление выбранной камеры.
Функции: enum класс SelectedCamera с BACK и FRONT, метод other().
Ответственность: представление выбранной камеры.

StartReceiverActivity.kt
Активность для запуска сервиса через ресивер.
Функции: onCreate() - запускает сервис и закрывается.
Ответственность: запуск фоновой записи через внешний триггер.

VolumeKeyPressListener.kt
Интерфейс для обработки нажатий клавиш громкости.
Функции: onVolumeKeyDown() - метод для обработки нажатия.
Ответственность: обработка клавиш громкости для управления записью.

RecordTileService.kt
Сервис для плитки быстрого доступа (Quick Settings Tile).
Функции: onClick() - переключает запись при нажатии на плитку.
Ответственность: управление записью через плитку в настройках.

Директория keys/
keys/EditKeyDialog.kt
Диалог для редактирования ключа.
Функции: onCreateDialog() - создает диалог для ввода имени ключа.
Ответственность: редактирование имени ключа.

keys/ImportKey.kt
Класс для импорта ключа.
Функции: parseImportUri() - парсит URI для импорта ключа.
Ответственность: обработка импорта ключей из URI.

keys/ImportKeyDialog.kt
Диалог для импорта ключа.
Функции: onCreateDialog() - создает диалог для ввода ключа.
Ответственность: ввод и импорт нового ключа.

keys/KeyManager.kt
Уже описан выше.

Директория keys/keyDetail/
keys/keyDetail/CreateQrCode.kt
Создание QR кода для ключа.
Функции: createQrCode() - генерирует QR код из публичного ключа.
Ответственность: генерация QR кода для обмена ключами.

keys/keyDetail/KeyDetailFragment.kt
Фрагмент деталей ключа.
Функции: onViewCreated() - настраивает UI для показа деталей ключа, QR кода.
Ответственность: отображение информации о ключе.

keys/keyDetail/KeyDetailKey.kt
Ключ для фрагмента деталей ключа.
Функции: data class KeyDetailKey с полем recipient.
Ответственность: передача данных для фрагмента деталей.

Директория keys/keyList/
keys/keyList/KeyAdapter.kt
Адаптер для списка ключей.
Функции: onCreateViewHolder(), onBindViewHolder() - управление элементами списка.
Ответственность: отображение списка ключей в RecyclerView.

keys/keyList/KeyItem.kt
Модель элемента списка ключей.
Функции: data class KeyItem с полями для отображения.
Ответственность: данные для элемента списка ключей.

keys/keyList/KeysFragment.kt
Фрагмент списка ключей.
Функции: onViewCreated() - настраивает список ключей, обработчики.
Ответственность: управление экраном списка ключей.

keys/keyList/KeysKey.kt
Ключ для фрагмента списка ключей.
Функции: data class KeysKey с опциональным полем recipient.
Ответственность: передача данных для фрагмента списка.

Директория keys/scanKey/
keys/scanKey/OnKeyScannedListener.kt
Интерфейс для обработки отсканированного ключа.
Функции: onKeyScanned() - метод для обработки отсканированного ключа.
Ответственность: обработка результатов сканирования QR кода ключа.

keys/scanKey/ScannerFragment.kt
Фрагмент для сканирования QR кода.
Функции: onViewCreated() - настраивает сканер камерой.
Ответственность: сканирование QR кодов ключей.

keys/scanKey/ScannerKey.kt
Ключ для фрагмента сканера.
Функции: object ScannerKey.
Ответственность: ключ для навигации к сканеру.

Директория onboarding/
onboarding/PickKeyFragment.kt
Фрагмент выбора ключа.
Функции: onViewCreated() - настраивает UI для выбора ключа.
Ответственность: экран выбора ключа при первом запуске.

onboarding/PickKeyKey.kt
Ключ для фрагмента выбора ключа.
Функции: object PickKeyKey.
Ответственность: ключ для навигации к выбору ключа.

onboarding/PickKeyViewModel.kt
ViewModel для выбора ключа.
Функции: класс с логикой выбора ключа.
Ответственность: управление состоянием выбора ключа.

onboarding/PickOutputDirFragment.kt
Фрагмент выбора выходной директории.
Функции: onViewCreated() - настраивает выбор папки.
Ответственность: экран выбора папки для сохранения файлов.

onboarding/PickOutputDirKey.kt
Ключ для фрагмента выбора директории.
Функции: object PickOutputDirKey.
Ответственность: ключ для навигации к выбору директории.

Директория preference/
preference/CameraIdSettingsFragment.kt
Фрагмент настроек ID камеры.
Функции: onCreatePreferences() - создает настройки для выбора ID камеры.
Ответственность: настройка пользовательского ID камеры.

preference/CameraIdSettingsKey.kt
Ключ для фрагмента настроек камеры.
Функции: object CameraIdSettingsKey.
Ответственность: ключ для навигации к настройкам камеры.

preference/LicensesFragment.kt
Фрагмент лицензий.
Функции: onViewCreated() - показывает лицензии библиотек.
Ответственность: отображение лицензионной информации.

preference/LicensesKey.kt
Ключ для фрагмента лицензий.
Функции: object LicensesKey.
Ответственность: ключ для навигации к лицензиям.

preference/SettingsFragment.kt
Фрагмент основных настроек.
Функции: onCreatePreferences() - создает все настройки приложения.
Ответственность: управление настройками приложения.

preference/SettingsKey.kt
Ключ для фрагмента настроек.
Функции: object SettingsKey.
Ответственность: ключ для навигации к настройкам.

Директория util/
util/ByteBufferInputStream.kt
Класс для чтения из ByteBuffer как InputStream.
Функции: read() - чтение байтов из буфера.
Ответственность: утилита для работы с байтовыми буферами.

Директория video/
video/CameraDebugFragment.kt
Фрагмент отладки камеры.
Функции: onViewCreated() - показывает информацию о камере.
Ответственность: отладка настроек камеры.

video/CameraDebugKey.kt
Ключ для фрагмента отладки.
Функции: object CameraDebugKey.
Ответственность: ключ для навигации к отладке.

video/RecordingManager.kt
Уже описан выше.

video/RecordingNotification.kt
Уведомление для записи.
Функции: notificationBuilder() - создает уведомление для фоновой записи.
Ответственность: создание уведомлений для сервиса записи.

video/RecordingService.kt
Уже описан выше.

video/VideoFragment.kt
Уже описан выше.

video/VideoKey.kt
Ключ для фрагмента видео.
Функции: object VideoKey.
Ответственность: ключ для навигации к видео экрану.

Скрипты:
complete_build.sh: скрипт сборки Go библиотек и релиз APK.
gradlew: Gradle wrapper для Unix.
gradlew.bat: Gradle wrapper для Windows.

Другие файлы:
.gitignore: игнорируемые файлы для Git.
.gitlab-ci.yml: конфигурация CI/CD для GitLab.
build.gradle: скрипт сборки Gradle.
fileformat.md: описание формата файлов.
gradle.properties: свойства Gradle.
LICENSE: лицензия проекта.
README.md: описание проекта.
settings.gradle: настройки Gradle.
age-encryption/: директория с Go кодом для шифрования.
fastlane/: директория для публикации в магазинах.
app/: директория Android приложения.
gradle/: wrapper для Gradle.
